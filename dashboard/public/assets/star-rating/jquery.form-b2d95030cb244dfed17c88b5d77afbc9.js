!function(e){function t(){if(e.fn.ajaxSubmit.debug){var t="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(t):window.opera&&window.opera.postError&&window.opera.postError(t)}}e.fn.ajaxSubmit=function(i){function n(t){for(var n=new FormData,s=0;s<t.length;s++)"file"!=t[s].type&&n.append(t[s].name,t[s].value);if(l.find("input:file:enabled").each(function(){var t=e(this).attr("name"),i=this.files;if(t)for(var s=0;s<i.length;s++)n.append(t,i[s])}),i.extraData)for(var o in i.extraData)n.append(o,i.extraData[o]);i.data=null;var a=e.extend(!0,{},e.ajaxSettings,i,{contentType:!1,processData:!1,cache:!1,type:"POST"});a.data=null;var r=a.beforeSend;a.beforeSend=function(e,t){t.data=n,e.upload&&(e.upload.onprogress=function(e){t.progress(e.position,e.total)}),r&&r.call(t,e,i)},e.ajax(a)}function s(n){function s(e){var t=e.contentWindow?e.contentWindow.document:e.contentDocument?e.contentDocument:e.document;return t}function a(){function i(){try{var e=s(g).readyState;t("state = "+e),"uninitialized"==e.toLowerCase()&&setTimeout(i,50)}catch(n){t("Server abort: ",n," (",n.name,")"),r(C),_&&clearTimeout(_),_=void 0}}var n=l.attr("target"),a=l.attr("action");x.setAttribute("target",p),o||x.setAttribute("method","POST"),a!=d.url&&x.setAttribute("action",d.url),d.skipEncodingOverride||o&&!/post/i.test(o)||l.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"}),d.timeout&&(_=setTimeout(function(){b=!0,r(k)},d.timeout));var c=[];try{if(d.extraData)for(var h in d.extraData)c.push(e('<input type="hidden" name="'+h+'">').attr("value",d.extraData[h]).appendTo(x)[0]);d.iframeTarget||(f.appendTo("body"),g.attachEvent?g.attachEvent("onload",r):g.addEventListener("load",r,!1)),setTimeout(i,15),x.submit()}finally{x.setAttribute("action",a),n?x.setAttribute("target",n):l.removeAttr("target"),e(c).remove()}}function r(i){if(!m.aborted&&!N){try{j=s(g)}catch(n){t("cannot access response document: ",n),i=C}if(i===k&&m)return m.abort("timeout"),void 0;if(i==C&&m)return m.abort("server abort"),void 0;if(j&&j.location.href!=d.iframeSrc||b){g.detachEvent?g.detachEvent("onload",r):g.removeEventListener("load",r,!1);var o,a="success";try{if(b)throw"timeout";var l="xml"==d.dataType||j.XMLDocument||e.isXMLDoc(j);if(t("isXml="+l),!l&&window.opera&&(null==j.body||""==j.body.innerHTML)&&--$)return t("requeing onLoad callback, DOM not available"),setTimeout(r,250),void 0;var c=j.body?j.body:j.documentElement;m.responseText=c?c.innerHTML:null,m.responseXML=j.XMLDocument?j.XMLDocument:j,l&&(d.dataType="xml"),m.getResponseHeader=function(e){var t={"content-type":d.dataType};return t[e]},c&&(m.status=Number(c.getAttribute("status"))||m.status,m.statusText=c.getAttribute("statusText")||m.statusText);var h=(d.dataType||"").toLowerCase(),p=/(json|script|text)/.test(h);if(p||d.textarea){var v=j.getElementsByTagName("textarea")[0];if(v)m.responseText=v.value,m.status=Number(v.getAttribute("status"))||m.status,m.statusText=v.getAttribute("statusText")||m.statusText;else if(p){var y=j.getElementsByTagName("pre")[0],x=j.getElementsByTagName("body")[0];y?m.responseText=y.textContent?y.textContent:y.innerText:x&&(m.responseText=x.textContent?x.textContent:x.innerText)}}else"xml"!=h||m.responseXML||null==m.responseText||(m.responseXML=E(m.responseText));try{S=I(m,h,d)}catch(i){a="parsererror",m.error=o=i||a}}catch(i){t("error caught: ",i),a="error",m.error=o=i||a}m.aborted&&(t("upload aborted"),a=null),m.status&&(a=m.status>=200&&m.status<300||304===m.status?"success":"error"),"success"===a?(d.success&&d.success.call(d.context,S,"success",m),u&&e.event.trigger("ajaxSuccess",[m,d])):a&&(void 0==o&&(o=m.statusText),d.error&&d.error.call(d.context,m,a,o),u&&e.event.trigger("ajaxError",[m,d,o])),u&&e.event.trigger("ajaxComplete",[m,d]),u&&!--e.active&&e.event.trigger("ajaxStop"),d.complete&&d.complete.call(d.context,m,a),N=!0,d.timeout&&clearTimeout(_),setTimeout(function(){d.iframeTarget||f.remove(),m.responseXML=null},100)}}}var c,h,d,u,p,f,g,m,v,y,b,_,x=l[0],w=!!e.fn.prop;if(n)if(w)for(h=0;h<n.length;h++)c=e(x[n[h].name]),c.prop("disabled",!1);else for(h=0;h<n.length;h++)c=e(x[n[h].name]),c.removeAttr("disabled");if(e(":input[name=submit],:input[id=submit]",x).length)return alert('Error: Form elements must not have name or id of "submit".'),void 0;if(d=e.extend(!0,{},e.ajaxSettings,i),d.context=d.context||d,p="jqFormIO"+(new Date).getTime(),d.iframeTarget?(f=e(d.iframeTarget),y=f.attr("name"),null==y?f.attr("name",p):p=y):(f=e('<iframe name="'+p+'" src="'+d.iframeSrc+'" />'),f.css({position:"absolute",top:"-1000px",left:"-1000px"})),g=f[0],m={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(i){var n="timeout"===i?"timeout":"aborted";t("aborting upload... "+n),this.aborted=1,f.attr("src",d.iframeSrc),m.error=n,d.error&&d.error.call(d.context,m,n,i),u&&e.event.trigger("ajaxError",[m,d,n]),d.complete&&d.complete.call(d.context,m,n)}},u=d.global,u&&!e.active++&&e.event.trigger("ajaxStart"),u&&e.event.trigger("ajaxSend",[m,d]),d.beforeSend&&d.beforeSend.call(d.context,m,d)===!1)return d.global&&e.active--,void 0;if(!m.aborted){v=x.clk,v&&(y=v.name,y&&!v.disabled&&(d.extraData=d.extraData||{},d.extraData[y]=v.value,"image"==v.type&&(d.extraData[y+".x"]=x.clk_x,d.extraData[y+".y"]=x.clk_y)));var k=1,C=2,D=e("meta[name=csrf-token]").attr("content"),T=e("meta[name=csrf-param]").attr("content");T&&D&&(d.extraData=d.extraData||{},d.extraData[T]=D),d.forceSync?a():setTimeout(a,10);var S,j,N,$=50,E=e.parseXML||function(e,t){return window.ActiveXObject?(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(e)):t=(new DOMParser).parseFromString(e,"text/xml"),t&&t.documentElement&&"parsererror"!=t.documentElement.nodeName?t:null},P=e.parseJSON||function(e){return window.eval("("+e+")")},I=function(t,i,n){var s=t.getResponseHeader("content-type")||"",o="xml"===i||!i&&s.indexOf("xml")>=0,a=o?t.responseXML:t.responseText;return o&&"parsererror"===a.documentElement.nodeName&&e.error&&e.error("parsererror"),n&&n.dataFilter&&(a=n.dataFilter(a,i)),"string"==typeof a&&("json"===i||!i&&s.indexOf("json")>=0?a=P(a):("script"===i||!i&&s.indexOf("javascript")>=0)&&e.globalEval(a)),a}}}if(!this.length)return t("ajaxSubmit: skipping submit process - no element selected"),this;var o,a,r,l=this;"function"==typeof i&&(i={success:i}),o=this.attr("method"),a=this.attr("action"),r="string"==typeof a?e.trim(a):"",r=r||window.location.href||"",r&&(r=(r.match(/^([^#]+)/)||[])[1]),i=e.extend(!0,{url:r,success:e.ajaxSettings.success,type:o||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},i);var c={};if(this.trigger("form-pre-serialize",[this,i,c]),c.veto)return t("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(i.beforeSerialize&&i.beforeSerialize(this,i)===!1)return t("ajaxSubmit: submit aborted via beforeSerialize callback"),this;var h=i.traditional;void 0===h&&(h=e.ajaxSettings.traditional);var d,u=this.formToArray(i.semantic);if(i.data&&(i.extraData=i.data,d=e.param(i.data,h)),i.beforeSubmit&&i.beforeSubmit(u,this,i)===!1)return t("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[u,this,i,c]),c.veto)return t("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;var p=e.param(u,h);d&&(p=p?p+"&"+d:d),"GET"==i.type.toUpperCase()?(i.url+=(i.url.indexOf("?")>=0?"&":"?")+p,i.data=null):i.data=p;var f=[];if(i.resetForm&&f.push(function(){l.resetForm()}),i.clearForm&&f.push(function(){l.clearForm(i.includeHidden)}),!i.dataType&&i.target){var g=i.success||function(){};f.push(function(t){var n=i.replaceTarget?"replaceWith":"html";e(i.target)[n](t).each(g,arguments)})}else i.success&&f.push(i.success);i.success=function(e,t,n){for(var s=i.context||i,o=0,a=f.length;a>o;o++)f[o].apply(s,[e,t,n||l,l])};var m=e("input:file:enabled[value]",this),v=m.length>0,y="multipart/form-data",b=l.attr("enctype")==y||l.attr("encoding")==y,_=!!(v&&m.get(0).files&&window.FormData);t("fileAPI :"+_);var x=(v||b)&&!_;return i.iframe!==!1&&(i.iframe||x)?i.closeKeepAlive?e.get(i.closeKeepAlive,function(){s(u)}):s(u):(v||b)&&_?(i.progress=i.progress||e.noop,n(u)):e.ajax(i),this.trigger("form-submit-notify",[this,i]),this},e.fn.ajaxForm=function(i){if(0===this.length){var n={s:this.selector,c:this.context};return!e.isReady&&n.s?(t("DOM not ready, queuing ajaxForm"),e(function(){e(n.s,n.c).ajaxForm(i)}),this):(t("terminating; zero elements found by selector"+(e.isReady?"":" (DOM not ready)")),this)}return this.ajaxFormUnbind().bind("submit.form-plugin",function(t){t.isDefaultPrevented()||(t.preventDefault(),e(this).ajaxSubmit(i))}).bind("click.form-plugin",function(t){var i=t.target,n=e(i);if(!n.is(":submit,input:image")){var s=n.closest(":submit");if(0==s.length)return;i=s[0]}var o=this;if(o.clk=i,"image"==i.type)if(void 0!=t.offsetX)o.clk_x=t.offsetX,o.clk_y=t.offsetY;else if("function"==typeof e.fn.offset){var a=n.offset();o.clk_x=t.pageX-a.left,o.clk_y=t.pageY-a.top}else o.clk_x=t.pageX-i.offsetLeft,o.clk_y=t.pageY-i.offsetTop;setTimeout(function(){o.clk=o.clk_x=o.clk_y=null},100)})},e.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")},e.fn.formToArray=function(t){var i=[];if(0===this.length)return i;var n=this[0],s=t?n.getElementsByTagName("*"):n.elements;if(!s)return i;var o,a,r,l,c,h,d;for(o=0,h=s.length;h>o;o++)if(c=s[o],r=c.name)if(t&&n.clk&&"image"==c.type)c.disabled||n.clk!=c||(i.push({name:r,value:e(c).val(),type:c.type}),i.push({name:r+".x",value:n.clk_x},{name:r+".y",value:n.clk_y}));else if(l=e.fieldValue(c,!0),l&&l.constructor==Array)for(a=0,d=l.length;d>a;a++)i.push({name:r,value:l[a]});else null!==l&&"undefined"!=typeof l&&i.push({name:r,value:l,type:c.type});if(!t&&n.clk){var u=e(n.clk),p=u[0];r=p.name,r&&!p.disabled&&"image"==p.type&&(i.push({name:r,value:u.val()}),i.push({name:r+".x",value:n.clk_x},{name:r+".y",value:n.clk_y}))}return i},e.fn.formSerialize=function(t){return e.param(this.formToArray(t))},e.fn.fieldSerialize=function(t){var i=[];return this.each(function(){var n=this.name;if(n){var s=e.fieldValue(this,t);if(s&&s.constructor==Array)for(var o=0,a=s.length;a>o;o++)i.push({name:n,value:s[o]});else null!==s&&"undefined"!=typeof s&&i.push({name:this.name,value:s})}}),e.param(i)},e.fn.fieldValue=function(t){for(var i=[],n=0,s=this.length;s>n;n++){var o=this[n],a=e.fieldValue(o,t);null===a||"undefined"==typeof a||a.constructor==Array&&!a.length||(a.constructor==Array?e.merge(i,a):i.push(a))}return i},e.fieldValue=function(t,i){var n=t.name,s=t.type,o=t.tagName.toLowerCase();if(void 0===i&&(i=!0),i&&(!n||t.disabled||"reset"==s||"button"==s||("checkbox"==s||"radio"==s)&&!t.checked||("submit"==s||"image"==s)&&t.form&&t.form.clk!=t||"select"==o&&-1==t.selectedIndex))return null;if("select"==o){var a=t.selectedIndex;if(0>a)return null;for(var r=[],l=t.options,c="select-one"==s,h=c?a+1:l.length,d=c?a:0;h>d;d++){var u=l[d];if(u.selected){var p=u.value;if(p||(p=u.attributes&&u.attributes.value&&!u.attributes.value.specified?u.text:u.value),c)return p;r.push(p)}}return r}return e(t).val()},e.fn.clearForm=function(t){return this.each(function(){e("input,select,textarea",this).clearFields(t)})},e.fn.clearFields=e.fn.clearInputs=function(e){var t=/^(?:color|date|datetime|email|month|number|password|range|search|tel|text|time|url|week)$/i;return this.each(function(){var i=this.type,n=this.tagName.toLowerCase();t.test(i)||"textarea"==n||e&&/hidden/.test(i)?this.value="":"checkbox"==i||"radio"==i?this.checked=!1:"select"==n&&(this.selectedIndex=-1)})},e.fn.resetForm=function(){return this.each(function(){("function"==typeof this.reset||"object"==typeof this.reset&&!this.reset.nodeType)&&this.reset()})},e.fn.enable=function(e){return void 0===e&&(e=!0),this.each(function(){this.disabled=!e})},e.fn.selected=function(t){return void 0===t&&(t=!0),this.each(function(){var i=this.type;if("checkbox"==i||"radio"==i)this.checked=t;else if("option"==this.tagName.toLowerCase()){var n=e(this).parent("select");t&&n[0]&&"select-one"==n[0].type&&n.find("option").selected(!1),this.selected=t}})},e.fn.ajaxSubmit.debug=!1}(jQuery);